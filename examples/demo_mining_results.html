<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Mining Test Results</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .header {
            background: #343a40;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
        }
        .section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .section h2 {
            margin-top: 0;
            color: #343a40;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .file-list {
            display: grid;
            gap: 15px;
        }
        .file-item {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            background: #f8f9fa;
        }
        .file-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .filename {
            font-weight: bold;
            color: #495057;
        }
        .file-type {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .file-type.image { background: #d1ecf1; color: #0c5460; }
        .file-type.video { background: #d4edda; color: #155724; }
        .score {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        .score.positive { background: #d1ecf1; color: #0c5460; }
        .score.none { background: #f8d7da; color: #721c24; }
        .metadata-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .metadata-table th, .metadata-table td {
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid #dee2e6;
        }
        .metadata-table th {
            background: #e9ecef;
            font-weight: bold;
        }
        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        .keyword {
            background: #e7f3ff;
            color: #004085;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 0.8em;
        }
        .database-structure {
            background: #f1f3f4;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        .highlight { background: #fff3cd; padding: 2px 4px; border-radius: 3px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>🔍 Data Mining Test Results</h1>
        <p>Generated on 2025-09-14 05:11:16</p>
        <p>Source Directory: <code>media</code></p>
        <p>File Pattern: <code>*.png</code></p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">2</div>
            <div>Total Files</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">2</div>
            <div>Image Files</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">0</div>
            <div>Video Files</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">0</div>
            <div>Files with Scores</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">8</div>
            <div>Keywords Generated</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">2</div>
            <div>Files with Keywords</div>
        </div>
    </div>

    <div class="section">
        <h2>📂 File Details</h2>
        <div class="file-list">

            <div class="file-item">
                <div class="file-header">
                    <span class="filename">test_image_001.png</span>
                    <div>
                        <span class="file-type image">IMAGE</span>
                        <span class="score none">No Score</span>
                    </div>
                </div>
                
                <table class='metadata-table'><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Media File ID</td><td><code>66a41bc69a990178b9783dc76428fccee229a801d97180bfef022ceac53c1956</code></td></tr><tr><td>Perceptual Hash</td><td><code>0000000000000000</code></td></tr><tr><td>File Size</td><td>0.00 MB</td></tr><tr><td>File Modified At</td><td>2025-09-14 05:11:09</td></tr><tr><td>Width</td><td>512</td></tr><tr><td>Height</td><td>512</td></tr><tr><td>Color Mode</td><td>RGB</td></tr><tr><td>Has Alpha</td><td>False</td></tr><tr><td>Png Text</td><td>masterpiece, best quality, red background
Negative prompt: blurry
Steps: 20, Sampler: DPM++ 2M, CFG scale: 7, Seed: 12345, Size: 512x512, Model: test_model</td></tr><tr><td>Prompt</td><td>masterpiece, best quality, red background</td></tr><tr><td>Negative Prompt</td><td>blurry</td></tr><tr><td>Parsed Prompt Data</td><td>{
  "positive_keywords": [
    {
      "text": "masterpiece",
      "weight": 1.0
    },
    {
      "text": "best quality",
      "weight": 1.0
    },
    {
      "text": "red background",
      "wei...</td></tr><tr><td>Steps</td><td>20, Sampler: DPM++ 2M, CFG scale: 7, Seed: 12345, Size: 512x512, Model: test_model</td></tr></tbody></table>
                <div class="keywords"><span class="keyword">square</span><span class="keyword">best</span><span class="keyword">quality</span><span class="keyword">red</span><span class="keyword">512x512</span><span class="keyword">masterpiece</span><span class="keyword">background</span></div>
            </div>

            <div class="file-item">
                <div class="file-header">
                    <span class="filename">test_image_002.png</span>
                    <div>
                        <span class="file-type image">IMAGE</span>
                        <span class="score none">No Score</span>
                    </div>
                </div>
                
                <table class='metadata-table'><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Media File ID</td><td><code>2cb4d57da40aa90eddd34f65f933973f5705990c396a57fcb02ba2148be42402</code></td></tr><tr><td>Perceptual Hash</td><td><code>0000000000000000</code></td></tr><tr><td>File Size</td><td>0.00 MB</td></tr><tr><td>File Modified At</td><td>2025-09-14 05:11:09</td></tr><tr><td>Width</td><td>256</td></tr><tr><td>Height</td><td>256</td></tr><tr><td>Color Mode</td><td>RGB</td></tr><tr><td>Has Alpha</td><td>False</td></tr></tbody></table>
                <div class="keywords"><span class="keyword">square</span></div>
            </div>

        </div>
    </div>

    <div class="section">
        <h2>🗃️ Database Structure Preview</h2>
        <p>This shows how the extracted data would be organized in the database tables:</p>
        
        <div class="database-structure">
<strong>media_files</strong> table would contain:
┌────────────────────────────────────────────────────────────────────────────────────────────────┐
│ id │ filename │ directory │ file_path │ score │ file_type │ media_file_id │ phash │
├────────────────────────────────────────────────────────────────────────────────────────────────┤
│  1 │ test_image │ media     │ t_image_001.png │ NULL  │ image     │ 66a41bc69a990178... │ 0000000000000000 │
│  2 │ test_image │ media     │ t_image_002.png │ NULL  │ image     │ 2cb4d57da40aa90e... │ 0000000000000000 │
└────────────────────────────────────────────────────────────────────────────────────────────────┘

<strong>media_metadata</strong> table would contain technical metadata:
┌─────────────────────────────────────────────────────────────────┐
│ media_file_id │ width │ height │ duration │ model_name │ ... │
├─────────────────────────────────────────────────────────────────┤
│             1 │ 512   │ 512    │ NULL     │ NULL       │ ... │
│             2 │ 256   │ 256    │ NULL     │ NULL       │ ... │
└─────────────────────────────────────────────────────────────────┘

<strong>media_keywords</strong> table would contain 8 keyword entries:
┌─────────────────────────────────────────────────────────────────┐
│ media_file_id │ keyword │ keyword_type │ confidence │ source │
├─────────────────────────────────────────────────────────────────┤
│             1 │ square     │ auto         │ 1.0        │ metadata │
│             1 │ best       │ auto         │ 1.0        │ metadata │
│             2 │ square     │ auto         │ 1.0        │ metadata │
│ ... (3 more keyword entries) ... │
└─────────────────────────────────────────────────────────────────┘
        </div>
        
        <p><span class="highlight">💡 Tip:</span> Run with <code>--enable-database</code> to actually store this data in the database for searching and management via the web interface.</p>
    </div>

    <div class="section">
        <h2>🚀 Next Steps</h2>
        <ol>
            <li><strong>Review the extracted data above</strong> to ensure it meets your expectations</li>
            <li><strong>Run with database enabled:</strong> <code>python mine_data.py {self.settings.dir} --enable-database</code></li>
            <li><strong>Start the web interface:</strong> <code>python run.py --dir {self.settings.dir} --enable-database</code></li>
            <li><strong>Search and manage your media</strong> via the web interface at <code>http://localhost:7862</code></li>
        </ol>
    </div>

</body>
</html>